<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Release-plz</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="Release rust packages without using the command line.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Introduction</a></li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="github-action.html"><strong aria-hidden="true">2.</strong> GitHub Action</a></li><li class="chapter-item expanded "><a href="usage/index.html"><strong aria-hidden="true">3.</strong> Usage</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="usage/update.html"><strong aria-hidden="true">3.1.</strong> update</a></li><li class="chapter-item expanded "><a href="usage/release-pr.html"><strong aria-hidden="true">3.2.</strong> release-pr</a></li><li class="chapter-item expanded "><a href="usage/release.html"><strong aria-hidden="true">3.3.</strong> release</a></li><li class="chapter-item expanded "><a href="usage/shell-completions.html"><strong aria-hidden="true">3.4.</strong> shell-completions</a></li></ol></li><li class="chapter-item expanded "><a href="changelog-format.html"><strong aria-hidden="true">4.</strong> Changelog format</a></li><li class="chapter-item expanded "><a href="config.html"><strong aria-hidden="true">5.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="why.html"><strong aria-hidden="true">6.</strong> Why yet another release tool</a></li><li class="chapter-item expanded "><a href="extra/index.html"><strong aria-hidden="true">7.</strong> Extra</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="extra/releasing-binaries.html"><strong aria-hidden="true">7.1.</strong> Releasing binaries</a></li><li class="chapter-item expanded "><a href="extra/single-changelog.html"><strong aria-hidden="true">7.2.</strong> Single changelog</a></li><li class="chapter-item expanded "><a href="extra/yanked-packages.html"><strong aria-hidden="true">7.3.</strong> Yanked packages</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Release-plz</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/MarcoIeni/release-plz" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p><img src="assets/robot_text.jpeg" alt="release-plz-logo" /></p>
<h2 id="no-more-manual-releases"><a class="header" href="#no-more-manual-releases">No more manual releases</a></h2>
<p>Releasing Rust packages is tedious and error-prone, just like most IT manual tasks.
For every package you want to release, you need to:</p>
<ul>
<li>Increase the version in <code>Cargo.toml</code>.</li>
<li>Update the changelog.</li>
<li>Publish the package in the cargo registry (for example, <a href="https://crates.io">crates.io</a>).</li>
<li>Create and push a git tag.</li>
</ul>
<p>Meet <a href="https://github.com/MarcoIeni/release-plz">release-plz</a>, a Rust open-source
project that automates these tasks, allowing developers to release Rust packages
without the command line.</p>
<p>Release-plz creates a fully automated release pipeline, allowing you to
easily release changes more frequently, without the fear of
doing typos or other
subtle manual mistakes you can make when releasing from your terminal.</p>
<p>Here‚Äôs an example of a release Pull Request created on the release-plz repository itself:</p>
<p><img src="assets/pr.png" alt="pr" /></p>
<h2 id="release-plz-features"><a class="header" href="#release-plz-features">Release-plz features</a></h2>
<ul>
<li>Version update based on <a href="https://www.conventionalcommits.org/en/v1.0.0/">conventional commits</a>.</li>
<li>Changelog update with <a href="https://github.com/orhun/git-cliff">git-cliff</a>,
using the <a href="https://keepachangelog.com/en/1.1.0/">keep a changelog</a> format by default.</li>
<li>API breaking changes detection with <a href="https://github.com/obi1kenobi/cargo-semver-checks">cargo-semver-checks</a>.</li>
<li>Cargo workspaces support.</li>
<li>No configuration required.</li>
<li>Optional <code>cargo update</code> before releasing.</li>
<li>Git tag created for every released package.</li>
<li>Package published to any cargo registry.</li>
</ul>
<h2 id="releases-made-easy"><a class="header" href="#releases-made-easy">Releases made easy</a></h2>
<p>Release-plz makes releasing Rust packages child‚Äôs play:</p>
<ol>
<li>For every commit, release-plz creates a release Pull Request from CI.</li>
<li>The release Pull Request reminds the maintainer about the unpublished changes.</li>
<li>The maintainer reviews and merges the pull request.</li>
<li>Release-plz releases the updated packages from CI.</li>
</ol>
<p>In short, release-plz makes releasing Rust packages as easy as clicking the pull
request ‚Äúmerge‚Äù button.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<p>Make sure you have <code>git</code> and <code>openssl</code> installed when running <code>release-plz</code>.</p>
<p><code>release-plz</code> is a rust binary that can be installed in different ways.</p>
<h2 id="download-prebuilt-binary"><a class="header" href="#download-prebuilt-binary">Download prebuilt binary</a></h2>
<p>The latest release is on <a href="https://github.com/MarcoIeni/release-plz/releases/latest">GitHub</a>.</p>
<h2 id="cargo"><a class="header" href="#cargo">Cargo</a></h2>
<ul>
<li>Install the rust toolchain in order to have cargo installed by following
<a href="https://www.rust-lang.org/tools/install">this</a> guide.</li>
<li>Run <code>cargo install release-plz --locked</code>.</li>
</ul>
<h2 id="docker"><a class="header" href="#docker">Docker</a></h2>
<p>Run <code>docker pull marcoieni/release-plz</code>.</p>
<h2 id="aur"><a class="header" href="#aur">AUR</a></h2>
<p><code>release-plz</code> can be installed from available
<a href="https://aur.archlinux.org/packages?O=0&amp;SeB=b&amp;K=release-plz&amp;outdated=&amp;SB=n&amp;SO=a&amp;PP=50&amp;submit=Go">AUR packages</a>
using an <a href="https://wiki.archlinux.org/index.php/AUR_helpers">AUR helper</a>. For example:</p>
<ul>
<li><code>paru -S release-plz</code></li>
<li><code>paru -S release-plz-git</code> (VCS package)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="github-action"><a class="header" href="#github-action">GitHub action</a></h1>
<p>The simplest way to run release-plz is via the <a href="https://github.com/marketplace/actions/release-plz">GitHub action</a>.</p>
<p>By default, every time you merge a commit to the main branch, the GitHub action
runs two commands, one after the other:</p>
<ul>
<li><a href="usage/release-pr.html"><code>release-plz release-pr</code></a>: creates the release pr.</li>
<li><a href="usage/release.html"><code>release-plz release</code></a>: publishes the unpublished packages.</li>
</ul>
<h2 id="input-variables"><a class="header" href="#input-variables">Input variables</a></h2>
<ul>
<li><code>command</code>: The release-plz command to run. Accepted values: <code>release-pr</code>,
<code>release</code>. (By default it runs both commands).</li>
<li><code>registry</code>: Registry where the packages are stored.
The registry name needs to be present in the Cargo config.
If unspecified, crates.io is used. (Defaults to crates.io).</li>
<li><code>project_manifest</code>: Path to the Cargo.toml of the project you want to update.
Both Cargo workspaces and single packages are supported. (Defaults to the root
directory).</li>
<li><code>git_release</code>: Publish the GitHub release for the created git tag. (Default: <code>true</code>).</li>
<li><code>version</code>: Release-plz version to use. It must be an existing git tag name.
For example <code>release-plz-v0.2.45</code>. (Default: <code>&quot;latest&quot;</code>).</li>
</ul>
<h2 id="example-release-pr-and-release"><a class="header" href="#example-release-pr-and-release">Example: release-pr and release</a></h2>
<pre><code class="language-yaml">name: Release-plz

permissions:
  pull-requests: write
  contents: write

on:
  push:
    branches:
      - main

jobs:
  release-plz:
    name: Release-plz
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - name: Install Rust toolchain
        uses: dtolnay/rust-toolchain@stable
      - name: Run release-plz
        uses: MarcoIeni/release-plz-action@v0.4
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          CARGO_REGISTRY_TOKEN: ${{ secrets.CARGO_REGISTRY_TOKEN }}
</code></pre>
<ul>
<li><code>fetch-depth: 0</code> is needed to clone all the git history, which is necessary to
determine the next version and build the changelog.</li>
</ul>
<h2 id="example-release-pr"><a class="header" href="#example-release-pr">Example: release-pr</a></h2>
<pre><code class="language-yaml">name: Release-plz

permissions:
  pull-requests: write
  contents: write

on:
  push:
    branches:
      - main

jobs:
  release-plz:
    name: Release-plz
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - name: Install Rust toolchain
        uses: dtolnay/rust-toolchain@stable
      - name: Run release-plz
        uses: MarcoIeni/release-plz-action@v0.4
        with:
          command: release-pr
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
</code></pre>
<h2 id="example-release"><a class="header" href="#example-release">Example: release</a></h2>
<pre><code class="language-yaml">name: Release-plz

permissions:
  pull-requests: write
  contents: write

on:
  push:
    branches:
      - main

jobs:
  release-plz:
    name: Release-plz
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - name: Install Rust toolchain
        uses: dtolnay/rust-toolchain@stable
      - name: Run release-plz
        uses: MarcoIeni/release-plz-action@v0.4
        with:
          command: release
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          CARGO_REGISTRY_TOKEN: ${{ secrets.CARGO_REGISTRY_TOKEN }}
</code></pre>
<h2 id="example-release-pr-and-relase-on-schedule"><a class="header" href="#example-release-pr-and-relase-on-schedule">Example: release-pr and relase on schedule</a></h2>
<p>In the above examples, release-plz runs every time you merge a commit to the <code>main</code> branch.</p>
<p>To run release-plz periodically, you can use the
<a href="https://docs.github.com/en/actions/reference/events-that-trigger-workflows#schedule"><code>schedule</code></a> event:</p>
<pre><code class="language-yaml">name: Release-plz

permissions:
  pull-requests: write
  contents: write

# Trigger the workflow every Monday.
on:
  schedule:
    # * is a special character in YAML so you have to quote this string
    - cron:  '0 0 * * MON'

jobs:
  release-plz:
    name: Release-plz
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - name: Install Rust toolchain
        uses: dtolnay/rust-toolchain@stable
      - name: Run release-plz
        uses: MarcoIeni/release-plz-action@v0.4
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          CARGO_REGISTRY_TOKEN: ${{ secrets.CARGO_REGISTRY_TOKEN }}
</code></pre>
<h2 id="change-github-actions-permissions"><a class="header" href="#change-github-actions-permissions">Change GitHub actions permissions</a></h2>
<ol>
<li>
<p>Go to the GitHub actions settings:</p>
<p><img src="assets/actions_settings.png" alt="actions settings" /></p>
</li>
<li>
<p>Change ‚ÄúWorkflow permissions‚Äù to allow GitHub actions to create and approve
pull requests (needed to create and update the PR).</p>
<p><img src="assets/workflow_permissions.png" alt="workflow permission" /></p>
</li>
</ol>
<h2 id="triggering-further-workflow-runs"><a class="header" href="#triggering-further-workflow-runs">Triggering further workflow runs</a></h2>
<p>Pull requests created by GitHub actions using the default <code>GITHUB_TOKEN</code> cannot
trigger other workflows.
If you have <code>on: pull_request</code> or <code>on: push</code> workflows acting as checks on pull
requests, they will not run.</p>
<blockquote>
<p>When you use the repository‚Äôs <code>GITHUB_TOKEN</code> to perform tasks, events triggered
by the <code>GITHUB_TOKEN</code> will not create a new workflow run.
This prevents you from accidentally creating recursive workflow runs.
For example, if a workflow run pushes code using the repository‚Äôs <code>GITHUB_TOKEN</code>,
a new workflow will not run even when the repository contains a workflow
configured to run when <code>push</code> events occur.</p>
</blockquote>
<p>‚Äì <a href="https://docs.github.com/en/actions/using-workflows/triggering-a-workflow#triggering-a-workflow-from-a-workflow">GitHub Actions: Triggering a workflow from a workflow</a></p>
<p>Read <a href="https://github.com/peter-evans/create-pull-request/blob/main/docs/concepts-guidelines.md#triggering-further-workflow-runs">this</a>
guide to learn about possible workarounds, such as setting a Personal Access
Token, a deploy key or a GitHub app.</p>
<p>If you want to use the release-plz logo for the GitHub app,
you can find it <a href="assets/robot_head.jpeg">here</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="usage"><a class="header" href="#usage">Usage</a></h1>
<p>Release-plz updates the versions and changelogs of your rust packages, by
analyzing your git history:</p>
<ul>
<li><a href="usage/update.html"><code>release-plz update</code></a> updates your project locally, without
committing any change.</li>
<li><a href="usage/release-pr.html"><code>release-plz release-pr</code></a> opens a GitHub Pull Request.</li>
</ul>
<p>Once the changes are merged to the main branch, you can use
<a href="usage/release.html"><code>release-plz release</code></a> to publish the new versions of the packages.</p>
<p>To learn more about how to use release-plz, run <code>release-plz --help</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="update"><a class="header" href="#update">Update</a></h1>
<p>The <code>release-plz update</code> command updates the version and the changelog of the
packages of a local workspace.</p>
<p>The command:</p>
<ul>
<li>Downloads the packages of the project from the cargo registry.</li>
<li>Compares the local packages with the downloaded ones to determine the new commits.</li>
<li>Checks for API breaking changes in libraries if
<a href="https://github.com/obi1kenobi/cargo-semver-checks">cargo-semver-checks</a>
is installed.
<em>Warning:</em> <code>cargo-semver-checks</code> doesn‚Äôt catch every semver violation.</li>
<li>Updates the packages versions based on the messages of the new commits (based
on <a href="https://www.conventionalcommits.org/en/v1.0.0/">conventional commits</a> and
<a href="https://semver.org/">semantic versioning</a>).</li>
<li>Updates the packages changelogs with the messages of the new commits.</li>
<li>Updates all dependencies by running <code>cargo update</code> (disabled by default).</li>
</ul>
<p>In the following example, I run <code>release-plz</code> on the <code>release-plz</code> project itself.
<code>Release-plz</code> increases the version and the changelog of the packages with
unpublished changes.</p>
<p><img src="https://user-images.githubusercontent.com/11428655/160762832-54300ddb-ec9c-4538-a611-c66490c47333.gif" alt="release-plz update" /></p>
<p>To learn more, run <code>release-plz update --help</code>.</p>
<h2 id="faq"><a class="header" href="#faq">FAQ</a></h2>
<h3 id="does-the-changelog-include-the-commits-from-the-whole-repo"><a class="header" href="#does-the-changelog-include-the-commits-from-the-whole-repo">Does the changelog include the commits from the whole repo?</a></h3>
<p>The changelog of each crate includes the commit that changed one of the
files of the crate or one of its dependencies.</p>
<h3 id="what-if-a-commit-doesnt-follow-the-conventional-commits-format"><a class="header" href="#what-if-a-commit-doesnt-follow-the-conventional-commits-format">What if a commit doesn‚Äôt follow the conventional-commits format?</a></h3>
<p>By default, it will be listed under the section <code>### Other</code>.
Remember you can customize the changelog format by providing a
<a href="https://github.com/orhun/git-cliff">git-cliff</a> config file.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="release-pr"><a class="header" href="#release-pr">Release PR</a></h1>
<p>The <code>release-plz release-pr</code> command runs <a href="usage/update.html"><code>release-plz update</code></a> and
opens a GitHub Pull Request that prepares the next release.</p>
<p>When the project maintainer merges the release pull request, the packages are
ready to be published.</p>
<p>Here‚Äôs an example of a <a href="https://github.com/MarcoIeni/release-plz/pull/377">PR</a>
opened by release-plz in the release-plz GitHub project itself.</p>
<p>In the following example, I run <code>release-plz</code> on the <code>release-plz</code> project
itself.
<code>Release-plz</code> opens a PR that increases the version and the changelog of the
packages with unpublished changes.</p>
<p><img src="https://user-images.githubusercontent.com/11428655/160772903-544c7578-7c17-4311-b6ca-a1aefeabe799.gif" alt="release-plz release-pr" /></p>
<p>To learn more, run <code>release-plz release-pr --help</code>.</p>
<h2 id="pr-update"><a class="header" href="#pr-update">Pr update</a></h2>
<p>If there‚Äôs already an open release PR:</p>
<ul>
<li>if the PR contains commits that are not from bots (except the first one),
release-plz closes the PR to preserve the git history.
(Not available on Gitea).</li>
<li>otherwise, release-plz closes the old PR and opens a new one.</li>
</ul>
<h2 id="gitea"><a class="header" href="#gitea">Gitea</a></h2>
<p><code>release-plz release-pr</code> also supports creating PRs for repositories hosted on
Gitea with the <code>--backend</code> flag:</p>
<p><code>release-plz release-pr --token &lt;gitea application token&gt; --backend gitea</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="release"><a class="header" href="#release">Release</a></h1>
<p>The <code>release-plz release</code> command releases all the unpublished packages.</p>
<blockquote>
<p>For example, let‚Äôs say you have a workspace with two packages: <code>pkg-a</code>
(version 0.3.1) and <code>pkg-b</code> (version 0.2.2).
The crates.io registry contains <code>pkg-a</code> version 0.3.1, but it doesn‚Äôt contain
<code>pkg-b</code> version 0.2.2 because you didn‚Äôt publish this version yet.
In this case, release-plz would release <code>pkg-b</code>.</p>
</blockquote>
<p>For every release, release-plz:</p>
<ul>
<li>Creates a git tag named <code>&lt;package_name&gt;-v&lt;version&gt;</code> (e.g. <code>tokio-v1.8.1</code>).</li>
<li>Publishes the package to the cargo registry by running <code>cargo publish</code>.</li>
</ul>
<p>Usually, you use the <code>release-plz release</code> command after you run <code>release-plz update</code>
or you merge a pull request opened with <code>release-plz release-pr</code>.</p>
<p>To learn more, run <code>release-plz release --help</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="generate-shell-completions"><a class="header" href="#generate-shell-completions">Generate shell completions</a></h1>
<p>To learn more, run <code>release-plz generate-completions --help</code>.</p>
<h2 id="zsh"><a class="header" href="#zsh">zsh</a></h2>
<p>To load completions in your current shell session:</p>
<pre><code class="language-sh">autoload bashcompinit; bashcompinit
source &lt;(release-plz generate-completions)
</code></pre>
<p>To load completions for every new session, execute once:</p>
<pre><code class="language-sh">release-plz generate-completions zsh &gt; _release-plz
sudo mv _release-plz /usr/local/share/zsh/site-functions/
</code></pre>
<h2 id="bash"><a class="header" href="#bash">bash</a></h2>
<p>To load completions in your current shell session:</p>
<pre><code class="language-sh">source &lt;(release-plz generate-completions)
</code></pre>
<p>To load completions for every new session, execute once:</p>
<pre><code class="language-sh">release-plz generate-completions bash &gt; ~/.local/share/bash-completion/completions/release-plz
</code></pre>
<p>Note: package <code>bash-completion</code> is required for this to work.</p>
<h2 id="fish"><a class="header" href="#fish">fish</a></h2>
<p>To load completions in your current shell session:</p>
<pre><code class="language-sh">release-plz generate-completions fish | source
</code></pre>
<p>To load completions for every new session, execute once:</p>
<pre><code class="language-sh">release-plz generate-completions fish &gt; $HOME/.config/fish/completions/release-plz.fish
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="changelog-format"><a class="header" href="#changelog-format">Changelog format</a></h1>
<p>Release-plz generates the changelog by using <a href="https://github.com/orhun/git-cliff">git-cliff</a>.
By default, release-plz uses the
<a href="https://keepachangelog.com/en/1.1.0/">keep a changelog</a> format.
You can customize the changelog format, by providing a git-cliff configuration
file with the <code>--changelog-config</code> argument, or with the
<a href="config.html#the-changelog_config-field"><code>changelog_config</code></a> of the configuration file.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configuration"><a class="header" href="#configuration">Configuration</a></h1>
<p>This section describes how you can customize the behavior of release-plz
with the <code>release-plz.toml</code> file.</p>
<p>This configuration file is optional ‚Äî release-plz is designed to work out of the box,
with decent defaults.</p>
<p>Put the <code>release-plz.toml</code> file in the same directory of your root <code>Cargo.toml</code>.</p>
<h2 id="reference"><a class="header" href="#reference">Reference</a></h2>
<p>The configuration file is written in the <a href="https://toml.io/">TOML</a> format and consists of
the following sections:</p>
<ul>
<li><a href="config.html#the-workspace-section"><code>[workspace]</code></a> ‚Äî Defines the default configuration.
<ul>
<li><a href="config.html#the-update_dependencies-field"><code>update_dependencies</code></a> ‚Äî Update all dependencies.</li>
<li><a href="config.html#the-changelog_config-field"><code>changelog_config</code></a> ‚Äî Path to the <a href="https://github.com/orhun/git-cliff">git-cliff</a> configuration file.</li>
<li><a href="config.html#the-allow_dirty-field"><code>allow_dirty</code></a> ‚Äî Update dirty working directories.</li>
<li><a href="config.html#the-repo_url-field"><code>repo_url</code></a> ‚Äî Repository URL.</li>
<li><a href="config.html#the-semver_check-field"><code>semver_check</code></a> ‚Äî Run <a href="https://github.com/obi1kenobi/cargo-semver-checks">cargo-semver-checks</a>.</li>
<li><a href="config.html#the-update_changelog-field"><code>update_changelog</code></a> ‚Äî Update changelog.</li>
</ul>
</li>
<li><a href="config.html#the-package-section"><code>[package]</code></a> ‚Äî Defines the package-specific configurations.
<ul>
<li><a href="config.html#the-semver_check-field-package-section"><code>semver_check</code></a> ‚Äî Run <a href="https://github.com/obi1kenobi/cargo-semver-checks">cargo-semver-checks</a>.</li>
<li><a href="config.html#the-update_changelog-field-package-section"><code>update_changelog</code></a> ‚Äî Update changelog.</li>
<li><a href="config.html#the-changelog_path-field-package-section"><code>changelog_path</code></a> ‚Äî Changelog path.</li>
</ul>
</li>
</ul>
<h3 id="the-workspace-section"><a class="header" href="#the-workspace-section">The <code>[workspace]</code> section</a></h3>
<p>Defines the global configuration, applied to all packages by default.
This section is optional, as well as all its fields.</p>
<p>Here‚Äôs an example configuration:</p>
<pre><code class="language-toml">[workspace]
update_dependencies = true # update dependencies with `cargo update`
changelog_config = &quot;config/git-cliff.toml&quot;
allow_dirty = true # allow updating repositories with uncommitted changes
repo_url = &quot;https://github.com/&lt;owner&gt;/&lt;repo&gt;&quot;
semver_check = &quot;no&quot;
update_changelog = false
</code></pre>
<h4 id="the-update_dependencies-field"><a class="header" href="#the-update_dependencies-field">The <code>update_dependencies</code> field</a></h4>
<ul>
<li>If <code>true</code>, update all the dependencies in the <code>Cargo.lock</code> file by running <code>cargo update</code>.</li>
<li>If <code>false</code>, only update the workspace packages by running <code>cargo update --workspace</code>. <em>(Default)</em>.</li>
</ul>
<h4 id="the-changelog_config-field"><a class="header" href="#the-changelog_config-field">The <code>changelog_config</code> field</a></h4>
<p>Path to the <a href="https://github.com/orhun/git-cliff">git-cliff</a> configuration file.
If unspecified, release-plz uses the <a href="https://keepachangelog.com/en/1.1.0/">keep a changelog</a> format.
You can learn more in the <a href="changelog-format.html">changelog format</a> section.</p>
<h4 id="the-allow_dirty-field"><a class="header" href="#the-allow_dirty-field">The <code>allow_dirty</code> field</a></h4>
<ul>
<li>If <code>true</code>, allow release-plz to update dirty working directories.
A directory is considered dirty if it contains uncommitted changes.
The uncommitted changes will be part of the update.</li>
<li>If <code>false</code>, release-plz returns an error if the repository contains uncommitted changes. <em>(Default)</em>.</li>
</ul>
<p>Note: This field is different from the <code>allow-dirty</code> flag of the <code>release-plz release</code> command.
This field only affects the <code>release-plz update</code> and <code>release-plz release-pr</code> command.</p>
<h4 id="the-repo_url-field"><a class="header" href="#the-repo_url-field">The <code>repo_url</code> field</a></h4>
<p>GitHub/Gitea repository URL where your project is hosted.
It is used to generate the changelog release link and open the PR.
Normally, you don‚Äôt need to set this field,
because release-plz defaults to the URL of the default git remote.</p>
<h4 id="the-semver_check-field"><a class="header" href="#the-semver_check-field">The <code>semver_check</code> field</a></h4>
<p>With this field, you can tell release-plz when to run <a href="https://github.com/obi1kenobi/cargo-semver-checks">cargo-semver-checks</a>:</p>
<ul>
<li>If <code>&quot;no&quot;</code>, never run it.</li>
<li>If <code>&quot;yes&quot;</code>, always run it.</li>
<li>If <code>&quot;lib&quot;</code>, run it if the package is a library. <em>(Default)</em>.</li>
</ul>
<p>This field can be overridden in the <a href="config.html#the-package-section"><code>[package]</code></a> section.</p>
<h4 id="the-update_changelog-field"><a class="header" href="#the-update_changelog-field">The <code>update_changelog</code> field</a></h4>
<ul>
<li>If <code>true</code>, update the changelog of the crates. <em>(Default)</em>.</li>
<li>If <code>false</code>, don‚Äôt update changelogs.</li>
</ul>
<p>This field can be overridden in the <a href="config.html#the-package-section"><code>[package]</code></a> section.</p>
<h3 id="the-package-section"><a class="header" href="#the-package-section">The <code>[package]</code> section</a></h3>
<p>In this section, you can override some of the <code>workspace</code> fields for specific packages.
This section is optional, as well as all its fields.</p>
<pre><code class="language-toml">[package.my_package]
semver_check = &quot;no&quot;
update_changelog = false
changelog_path = &quot;docs/CHANGELOG.md&quot;
</code></pre>
<h4 id="the-semver_check-field-package-section"><a class="header" href="#the-semver_check-field-package-section">The <code>semver_check</code> field (<code>package</code> section)</a></h4>
<ul>
<li>If <code>&quot;yes&quot;</code>, run <a href="https://github.com/obi1kenobi/cargo-semver-checks">cargo-semver-checks</a> for this package.</li>
<li>If <code>&quot;no&quot;</code>, don‚Äôt.</li>
</ul>
<p>By default, release-plz runs <a href="https://github.com/obi1kenobi/cargo-semver-checks">cargo-semver-checks</a> if the package is a library.</p>
<h4 id="the-update_changelog-field-package-section"><a class="header" href="#the-update_changelog-field-package-section">The <code>update_changelog</code> field (<code>package</code> section)</a></h4>
<ul>
<li>If <code>true</code>, update the changelog of this package. <em>(Default)</em>.</li>
<li>If <code>false</code>, don‚Äôt.</li>
</ul>
<h4 id="the-changelog_path-field-package-section"><a class="header" href="#the-changelog_path-field-package-section">The <code>changelog_path</code> field (<code>package</code> section)</a></h4>
<p>By default, release-plz looks for the changelog in the <code>CHANGELOG.md</code> file
of the same directory of the <code>Cargo.toml</code> of the package:</p>
<pre><code class="language-txt">.
‚îú‚îÄ‚îÄ src/
‚îú‚îÄ‚îÄ CHANGELOG.md
‚îî‚îÄ‚îÄ Cargo.toml
</code></pre>
<p>If the changelog of a package is in a different location, you can specify it with this field.</p>
<p>This field is relative to the root <code>Cargo.toml</code> file.
In GitHub actions, this is the root of the repository.</p>
<p>This field cannot be set in the <code>[workspace]</code> section.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="why-yet-another-release-tool"><a class="header" href="#why-yet-another-release-tool">Why yet another release tool</a></h1>
<p>New Rust apps and rewrites are mushrooming every day.
Choosing which tools to add to your developer toolbox is becoming harder and harder.</p>
<p>I feel obliged to explain why I created this project and how it compares with
similar tools.</p>
<h2 id="differences-with-release-please"><a class="header" href="#differences-with-release-please">Differences with release-please</a></h2>
<p>Like release-plz, release-please is an open-source project that manages releases
via pull requests.
However, there are some differences.</p>
<h3 id="no-configuration-needed"><a class="header" href="#no-configuration-needed">No configuration needed</a></h3>
<p>Release-please requires two configuration files: <code>.release-please-manifest.json</code>
and <code>release-please-config.json</code>.
Most of the fields you have to write in these two files are already in the
<code>Cargo.toml</code> files.</p>
<p>Release-plz obtains all the information it needs from the <code>Cargo.toml</code> files
and the cargo registry,
so no configuration files are required.</p>
<h3 id="versions-retrieved-from-the-cargo-registry"><a class="header" href="#versions-retrieved-from-the-cargo-registry">Versions retrieved from the cargo registry</a></h3>
<p>Release-please considers a package ‚Äúpublished‚Äù only when the relative git tag exists.
Release-please doesn‚Äôt interact at all with cargo registries.
However, some Rust projects don‚Äôt create git tags.
Instead, they just publish the package to crates.io.</p>
<p>Release-plz looks at the cargo registry if the relative git tag doesn‚Äôt exist,
making it compatible with both workflows and with the majority of the Rust projects.</p>
<h3 id="no-multiple-programming-languages-support"><a class="header" href="#no-multiple-programming-languages-support">No multiple programming languages support</a></h3>
<p>Release-please supports multiple programming languages, while release-plz only
supports Rust projects.</p>
<h2 id="differences-with-other-rust-release-tools"><a class="header" href="#differences-with-other-rust-release-tools">Differences with other Rust release tools</a></h2>
<p>These are other release tools in the Rust ecosystem, but they primarily focus on
the CLI use case, while release-plz focuses mainly on CI.</p>
<ul>
<li><a href="https://github.com/crate-ci/cargo-release">cargo-release</a>:
<ul>
<li>Bumps the version and publishes Rust packages from the CLI.</li>
<li>It supports automatic releases with <code>cargo release --unpublished</code></li>
<li>It doesn‚Äôt have first-class support for changelogs.
See <a href="https://github.com/crate-ci/cargo-release/issues/231">this</a> issue.</li>
<li>It supports hooks (release-plz doesn‚Äôt).</li>
</ul>
</li>
<li><a href="https://github.com/pksunkara/cargo-workspaces">cargo-workspaces</a>:
<ul>
<li>It‚Äôs a set of commands to manage cargo workspaces and their crates.</li>
<li>The <code>publish</code> command releases the packages from the CLI similarly to <code>cargo-release</code>.</li>
</ul>
</li>
<li><a href="https://github.com/Byron/gitoxide/tree/main/cargo-smart-release">cargo-smart-release</a>:
<ul>
<li>Updates and publishes packages from the CLI.</li>
<li>It‚Äôs very similar to release-plz, but it is not meant to be run in CI (see
<a href="https://github.com/MarcoIeni/release-plz/issues/13#issuecomment-1065790846">this</a>
comment from the author).</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="extra"><a class="header" href="#extra">Extra</a></h1>
<p>This section contains information about possible use cases of release-plz.
You will also learn how to use release-plz with other tools, to achieve awesome
things.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="releasing-binaries"><a class="header" href="#releasing-binaries">Releasing binaries</a></h1>
<h2 id="why-release-plz-doesnt-release-binaries"><a class="header" href="#why-release-plz-doesnt-release-binaries">Why release-plz doesn‚Äôt release binaries</a></h2>
<blockquote>
<p>Since release-plz already publishes GitHub releases, would it
make sense for it to build the binaries of the project and publish
them to the release assets? ü§î</p>
</blockquote>
<p>Not really. Releasing binaries requires setting a CI job different
from the one used to run <code>release-plz release</code> because:</p>
<ul>
<li><code>release-plz release</code> should run once (for example on an <code>ubuntu</code> CI image);</li>
<li>building binaries requires a different CI image for each platform
(e.g. <code>ubuntu</code>, <code>macos</code>, <code>windows</code>).</li>
</ul>
<p>Since users have to set up an additional CI job to build binaries, using release-plz
would not be more convenient than using a different tool.
Plus, releasing binaries is a complex task, which is already well-handled by
other tools in the Rust ecosystem.
For these reasons, release-plz doesn‚Äôt build and release binaries.</p>
<p>The next section explains how to use other tools to build and release binaries after
release-plz released the new version of your project.</p>
<h2 id="releasing-binaries-after-release"><a class="header" href="#releasing-binaries-after-release">Releasing binaries after release</a></h2>
<p>If you are using release-plz to release your project, you can
run a CI job on the ‚Äútag‚Äù or ‚Äúrelease‚Äù events to build and release the binaries.</p>
<p>Here is an example:</p>
<pre><code class="language-yaml">name: CD # Continuous Deployment

permissions:
  contents: write

on:
  release:
    types: [published]

env:
  CARGO_INCREMENTAL: 0
  CARGO_NET_GIT_FETCH_WITH_CLI: true
  CARGO_NET_RETRY: 10
  CARGO_TERM_COLOR: always
  RUST_BACKTRACE: 1
  RUSTFLAGS: -D warnings
  RUSTUP_MAX_RETRIES: 10

defaults:
  run:
    shell: bash

jobs:
  upload-assets:
    name: ${{ matrix.target }}
    if: github.repository_owner == 'MyOwner' &amp;&amp; startsWith(github.event.release.name, 'my-bin-v')
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        include:
          - target: aarch64-unknown-linux-gnu
            os: ubuntu-22.04
          - target: aarch64-unknown-linux-musl
            os: ubuntu-22.04
          - target: aarch64-apple-darwin
            os: macos-11
          - target: aarch64-pc-windows-msvc
            os: windows-2019
          - target: x86_64-unknown-linux-gnu
            os: ubuntu-22.04
          - target: x86_64-unknown-linux-musl
            os: ubuntu-22.04
          - target: x86_64-apple-darwin
            os: macos-11
          - target: x86_64-pc-windows-msvc
            os: windows-2019
          - target: x86_64-unknown-freebsd
            os: ubuntu-22.04
          - target: universal-apple-darwin
            os: macos-11
    timeout-minutes: 60
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Install Rust toolchain
        uses: dtolnay/rust-toolchain@stable
      - uses: taiki-e/setup-cross-toolchain-action@v1
        with:
          target: ${{ matrix.target }}
        if: startsWith(matrix.os, 'ubuntu') &amp;&amp; !contains(matrix.target, '-musl')
      - uses: taiki-e/install-action@cross
        if: contains(matrix.target, '-musl')
      - run: echo &quot;RUSTFLAGS=${RUSTFLAGS} -C target-feature=+crt-static&quot; &gt;&gt; &quot;${GITHUB_ENV}&quot;
        if: endsWith(matrix.target, 'windows-msvc')
      - uses: taiki-e/upload-rust-binary-action@v1
        with:
          bin: my-bin
          target: ${{ matrix.target }}
          tar: all
          zip: windows
          token: ${{ secrets.GITHUB_TOKEN }}
</code></pre>
<p>Some projects to consider for this task:</p>
<ul>
<li><a href="https://github.com/taiki-e/upload-rust-binary-action">upload-rust-binary-action</a>:
GitHub Action for building and uploading Rust binary to GitHub Releases.</li>
<li><a href="https://crates.io/crates/cargo-dist">cargo-dist</a>:
shippable application packaging for Rust.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="single-changelog"><a class="header" href="#single-changelog">Single changelog</a></h1>
<p>If you have a workspace with multiple packages, and you want to keep
track of the changes of just one package, you can customize your
<code>release-plz.toml</code> file like this:</p>
<pre><code class="language-toml">[workspace]
# disable the changelog for all packages
update_changelog = false

[package.my-important-package]
# enable the changelog for this package
update_changelog = true
# set the path of the changelog to the root of the repository
changelog_path = &quot;./CHANGELOG.md&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="yanked-packages"><a class="header" href="#yanked-packages">Yanked packages</a></h1>
<p>Due to <a href="https://github.com/rust-lang/cargo/issues/11693">this</a>
issue, release-plz can‚Äôt detect yanked packages.</p>
<p>If you run release-plz on a package that has been yanked, you will see the message:</p>
<pre><code class="language-txt">the local package has already a different version with respect to the registry package,
so release-plz will not update it
</code></pre>
<p>This is because release-plz thinks that the latest published version of your packages is the latest
non-yanked version.</p>
<p>If the current version of your package is yanked,
please update the version of your package to the next version manually.
To do this, you can use the <code>cargo set-version</code> command from <a href="https://github.com/killercup/cargo-edit">cargo-edit</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
