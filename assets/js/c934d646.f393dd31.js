"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[261],{717:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>l,toc:()=>i});var s=t(5893),r=t(1151);const a={},o="Output",l={id:"github/output",title:"Output",description:"After the action runs, it outputs the following properties:",source:"@site/docs/github/output.md",sourceDirName:"github",slug:"/github/output",permalink:"/docs/github/output",draft:!1,unlisted:!1,editUrl:"https://github.com/MarcoIeni/release-plz/tree/main/website/docs/github/output.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Quickstart",permalink:"/docs/github/quickstart"},next:{title:"GitHub token",permalink:"/docs/github/token"}},c={},i=[{value:"Example: read the output",id:"example-read-the-output",level:2}];function h(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"output",children:"Output"}),"\n",(0,s.jsx)(n.p,{children:"After the action runs, it outputs the following properties:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"prs"}),": The release PRs opened by release-plz.\nIt's an array of objects with the properties of ",(0,s.jsx)(n.code,{children:"pr"}),".\n",(0,s.jsxs)(n.em,{children:["(Not useful for now. Use ",(0,s.jsx)(n.code,{children:"pr"})," instead)"]}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"pr"}),": The release PR opened by release-plz.\nIt's a JSON object with the following properties:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"head_branch"}),": The name of the branch where the changes are implemented."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"base_branch"}),": The name of the branch the changes are pulled into.\nIt is the default branch of the repository. E.g. ",(0,s.jsx)(n.code,{children:"main"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"html_url"}),": The URL of the PR."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"number"}),": The number of the PR."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"releases"}),": The JSON output of the ",(0,s.jsx)(n.code,{children:"release"})," command.\nIt's an array of JSON objects with the following properties:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"package_name"}),": The name of the package that was released."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"tag"}),": git tag name of the package that was released. It's returned even if you have\n",(0,s.jsx)(n.a,{href:"/docs/config#the-git_tag_enable-field",children:"git_tag_enable"})," set to ",(0,s.jsx)(n.code,{children:"false"}),", so that\nyou can use this to create the git tag yourself."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"version"}),": The version of the package that was released."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"prs_created"}),": Whether release-plz created any release PR. ",(0,s.jsx)(n.em,{children:"Boolean."})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"releases_created"}),": Whether release-plz released any package. ",(0,s.jsx)(n.em,{children:"Boolean."})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"example-read-the-output",children:"Example: read the output"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'jobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout repository\n        uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n      - name: Install Rust toolchain\n        uses: dtolnay/rust-toolchain@stable\n      - name: Run release-plz\n        id: release-plz # <--- ID used to refer to the outputs. Don\'t forget it.\n        uses: MarcoIeni/release-plz-action@v0.5\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n          CARGO_REGISTRY_TOKEN: ${{ secrets.CARGO_REGISTRY_TOKEN }}\n      - name: Assert release\n        env:\n          RELEASES: ${{ steps.release-plz.outputs.releases }}\n          PRS: ${{ steps.release-plz.outputs.prs }}\n          PR: ${{ steps.release-plz.outputs.pr }}\n          PRS_CREATED: ${{ steps.release-plz.outputs.prs_created }}\n          RELEASES_CREATED: ${{ steps.release-plz.outputs.releases_created }}\n        run: |\n          set -e\n          echo "$RELEASES" # example: [{"package_name":"my-package","tag":"v0.1.0","version":"0.1.0"}]\n          echo "$PRS" # example: []\n          echo "$PR" # example: {}\n          echo "$PRS_CREATED" # example: true\n          echo "$RELEASES_CREATED" # example: true\n\n          # get the number of releases with jq\n          releases_length=$(echo "$RELEASES" | jq \'length\')\n          echo "releases_length: $releases_length"\n\n          # access the first release with jq\n          release_version=$(echo "$RELEASES" | jq -r \'.[0].version\')\n          echo "release_version: $release_version"\n\n          # access the first release with fromJSON. Docs: https://docs.github.com/en/actions/learn-github-actions/expressions\n          echo "release_version: ${{ fromJSON(steps.release-plz.outputs.releases)[0].version }}"\n\n          release_tag=$(echo "$RELEASES" | jq -r \'.[0].tag\')\n          echo "release_tag: $release_tag"\n\n          release_package_name=$(echo "$RELEASES" | jq -r \'.[0].package_name\')\n          echo "release_package_name: $release_package_name"\n\n          # print all names of released packages, one per line\n          echo "package_names: $(echo "$RELEASES" | jq -r \'.[].package_name\')"\n          # TODO: show how to store this in a variable and iterate over it (maybe an array?). PR welcome!\n\n          # iterate over released packages\n          for package_name in $(echo "$RELEASES" | jq -r \'.[].package_name\'); do\n              echo "released $package_name"\n          done\n\n          echo "pr_number: ${{ fromJSON(steps.release-plz.outputs.pr).number }}""\n'})})]})}function p(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>l,a:()=>o});var s=t(7294);const r={},a=s.createContext(r);function o(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);